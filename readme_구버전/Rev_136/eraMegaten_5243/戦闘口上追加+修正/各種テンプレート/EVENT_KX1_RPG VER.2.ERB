;-------------------------------------------------
;ライセンスフリー
;-------------------------------------------------

;-------------------------------------------------
;■台詞の行数を増やしたいときは
;			LOCALS:10 = 一行目
;			LOCALS:11 = 二行目
;			LOCALS:12 = 三行目
;			LOCALS:13 = 四行目
;			LOCALS:14 = 五行目
;と増やしていく
;メッセージ前に文章を出したいなら
;			PRINTL
;			PRINTL
;メッセージ後に文章を出したいなら
;			KSTR:0 = 一行目
;			KSTR:1 = 二行目
;			KSTR:2 = 三行目
;			KSTR:3 = 四行目
;			KSTR:4 = 五行目
;ナレーション的なもので囲いの中にならない
;
;例
;
;PRINTL あいうえお
;PRINTL かきくけこ
;LOCALS:10 = さしすせそ
;LOCALS:11 = たちつてと
;KSTR:0 = なにぬねの
;KSTR:1 = はひふへほ
;　　↓
;あいうえお
;かきくけこ
;┏>MESSAGE━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
;┃さしすせそ　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　┃
;┃たちつてと　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　┃
;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
;なにぬねの
;はひふへほ
;
;-------------------------------------------------

;-------------------------------------------------
@BATTLE_EVENT_KX1, ARG, ARG:1, ARG:2
;-------------------------------------------------
SIF ARG < 0 && NO:ARG != X1
	RETURN 0
VARSET LOCALS
VARSET KSTR

;KSTR:0 = 
;KSTR:1 = 
SELECTCASE TFLAG:戦闘イベント
	;COOP発動 ARGは発動者
	CASE 1
		LOCALS:10 = 
	;COOP参加
	CASE 2
		;主人がCOOP発動
		IF FLAG:行動順1 != -1 && FLAG:行動順1 == MASTER
			LOCALS:10 = 
		;それ以外
		ELSE
			LOCALS:10 = 
		ENDIF
	;被召喚時
	CASE 3
			LOCALS:10 = 
	;攻撃　ARGが攻撃をする仲魔、ARG:1が敵、ARG:2がダメージ量
	CASE 11
		CALLFORM SKILL_TYPE_{CFLAG:ARG:入力行動}
		LOCAL = MAXBASE:(ARG:1):GET_TYPE(RESULT)
		;味方に攻撃した
		;IF CFLAG:ARG:PTフラグ == CFLAG:(ARG:1):PTフラグ
		;相手が死んだ
		IF BASE:(ARG:1):ＨＰ <= 0
			LOCALS:10 = 
		;弱点をついた。つまりCOOP
		ELSEIF LOCAL > 100 && LOCAL < 999
			IF CFLAG:(ARG:1):防御フラグ
				LOCALS:10 = 
			ELSE
				;こっちはCOOP発動に回すためにカット
				RETURN 0
			ENDIF
		;大ダメージ
		ELSEIF ダメージ割合(ARG:1, ARG:2) > 50
			LOCALS:10 = 
		ELSEIF ダメージ割合(ARG:1, ARG:2) > 25
			LOCALS:10 = 
		ELSEIF ダメージ割合(ARG:1, ARG:2) > 0
			LOCALS:10 = 
		;無効された
		ELSEIF ダメージ割合(ARG:1, ARG:2) <= 0
			LOCALS:10 = 
		ENDIF
	;被ダメージ
	;ARGが攻撃を受ける仲魔、ARG:1が敵、ARG:2がダメージ量
	CASE 12
		;味方に攻撃された
		;IF CFLAG:ARG:PTフラグ == CFLAG:(ARG:1):PTフラグ
		;死んだ
		IF BASE:ARG:ＨＰ <= 0
			LOCALS:10 = 
		;瀕死
		ELSEIF 現HP割合(ARG) < 25
			LOCALS:10 = 
		;大ダメージ
		ELSEIF ダメージ割合(ARG, ARG:2) > 50
			LOCALS:10 = 
		;無効
		ELSEIF ARG:2 == 0
			LOCALS:10 = 
		;吸収
		ELSEIF ARG:2 < 0
			LOCALS:10 = 
		ENDIF
	;範囲攻撃
	;ARGが攻撃をする仲魔、ARG:1が攻撃された敵数、ARG:2が無効数(回避も含む)
	CASE 13
		;全弾命中した
		IF ARG:2 == 0
			LOCALS:10 = 
		;普通
		ELSEIF ARG:2 < ARG:1
			LOCALS:10 = 
		;全弾回避された
		ELSEIF ARG:2 == ARG:1
			LOCALS:10 = 
		ENDIF
	;範囲攻撃で敵を撃破した
	;ARGが攻撃をする仲魔、ARG:1が攻撃された敵数、ARG:2が撃破数
	CASE 14
		;全員撃破
		IF ARG:2 == ARG:1
			LOCALS:10 = 
		ELSE
			LOCALS:10 = 
		ENDIF
	;反射された
	CASE 15
			LOCALS:10 = 
	;反射した
	CASE 16
			LOCALS:10 = 
	;回避された
	CASE 17
			LOCALS:10 = 
	;回避した
	CASE 18
			LOCALS:10 = 
	;敵味方全体攻撃(詳細処理無し)
	;CASE 19
	;		LOCALS:10 = 
	;反撃を発動した
	CASE 20
		SELECTCASE TFLAG:発動連動スキル
		;ダッジカウンター
		CASE 2484
			LOCALS:10 = 
		;その他
		CASEELSE
			LOCALS:10 = 
		ENDSELECT
	;トリガースキルを発動した
	CASE 21
		SELECTCASE TFLAG:発動連動スキル
		;○○
		;CASE 
		;	LOCALS:10 = 
		;その他
		CASEELSE
			LOCALS:10 = 
		ENDSELECT
	;バッドステータスを受けた
	CASE 22
		SELECTCASE GET_STATE(CFLAG:ARG:ステート)
			CASE "HAPPY"
				LOCALS:10 = 
			CASE "SHOCK","FREEZE","BIND","PALYZE"
				LOCALS:10 = 
			CASE "PANIC"
				LOCALS:10 = 
			CASE "SLEEP"
				LOCALS:10 = 
			;CASE "CLOSE"
			CASE "POISON"
				LOCALS:10 = 
			;CASE "BOMB"
			CASE "CHARM"
				LOCALS:10 = 
			;CASE "CURSE"
			;CASE "FLY"
			;CASE "STONE"
			CASE "FLAME"
				LOCALS:10 = 
			CASE "SLIP"
				LOCALS:10 = 
			;CASE "BRAND"
			;その他の状態異常
			;CASEELSE
			ENDSELECT
		ENDIF
	;バトルに勝利した
	CASE 90
			LOCALS:10 = 
	;レベルアップした
	CASE 91
			LOCALS:10 = 
	;逃走に成功した
	CASE 92
			LOCALS:10 = 
	;逃走に失敗した
	CASE 93
			LOCALS:10 = 
	;戦闘開始時
	CASE 94
		IF FLAG:先制攻撃フラグ
			LOCALS:10 = 
		ELSEIF 現HP割合(ARG) < 25
			;瀕死
			LOCALS:10 = 
		ELSE
			LOCALS:10 = 
		ENDIF
	;バックアタックを受けた
	CASE 95
		IF 現HP割合(ARG) < 25
			;瀕死
			LOCALS:10 = 
		ELSE
			LOCALS:10 = 
		ENDIF
	;敵の先制攻撃を受けた
	CASE 96
		IF 現HP割合(ARG) < 25
			;瀕死
			LOCALS:10 = 
		ELSE
			LOCALS:10 = 
		ENDIF
ENDSELECT

;リンケージに参加した
IF TFLAG:戦闘イベント == 100
	IF 0
	;スキル分岐
	;ELSEIF CFLAG:(FLAG:行動順1):入力行動 == [[スキル:○○]]
	
	;キャラ分岐
	;ELSEIF NO:(FLAG:行動順1) == XXXX
	ELSE
		LOCALS:10 = 
	ENDIF
ENDIF

IF !(LOCALS:10 == "") && !(KSTR:0 == "")
	CALL MESSAGE_B2(CALLNAME:ARG,0, LOCALS:10, LOCALS:11, LOCALS:12, LOCALS:13, LOCALS:14)
	CALL 口上変数表示
ELSEIF !(LOCALS:10 == "")
	CALL MESSAGE_B2(CALLNAME:ARG,1, LOCALS:10, LOCALS:11, LOCALS:12, LOCALS:13, LOCALS:14)
ENDIF

;-------------------------------------------------
@BATTLE_MESSAGE_KX1,ARG,ARG:1 = 0
;-------------------------------------------------
VARSET LOCALS
VARSET KSTR
;使用したスキルの名前をLOCALSに代入
CALLFORM SKILL_NAME_{CFLAG:ARG:入力行動},ARG
LOCALS = %RESULTS%
;FLAG:ARG:ターゲット

;崩壊してる場合は口上表示しないようにもできる
;SIF TALENT:ARG:9
;	RETURN 0

CALLFORM SKILL_EFECT_{CFLAG:ARG:入力行動}
;コメントアウトしやすいように
IF 1 == 0
;-------------------------------------------------
;状態異常時
;-------------------------------------------------
;魅了時
ELSEIF CFLAG:ARG:ステート == GET_STATE_NUM("CHARM")
	;行動不能（ムラムラしている）
	IF CFLAG:ARG:入力行動 == 2314
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;混乱時
ELSEIF CFLAG:ARG:ステート == GET_STATE_NUM("PANIC")
	;金ばら撒き
	IF CFLAG:ARG:入力行動 == 2315
		LOCALS:10 = 
	;行動不能（ぼんやりしている）
	ELSEIF CFLAG:ARG:入力行動 == 2314
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;-------------------------------------------------
;特定スキル
;-------------------------------------------------
;これは通常攻撃
ELSEIF CFLAG:ARG:入力行動 == 0
	LOCALS:10 = 
;ELSEIF CFLAG:ARG:入力行動 == (スキル番号)
;	LOCALS:10 = 
;セクシーダンス
ELSEIF CFLAG:ARG:入力行動 == 1212
	LOCALS:10 = 
;キャンディボイス
ELSEIF CFLAG:ARG:入力行動 == 1213
	LOCALS:10 = 
;ファイナルヌード
ELSEIF CFLAG:ARG:入力行動 == 1214
	LOCALS:10 = 
;-------------------------------------------------
;銃攻撃（特殊弾丸含む）
;-------------------------------------------------
ELSEIF RANGE(CFLAG:ARG:入力行動,2101, 2200)
	;GUN
	IF CFLAG:ARG:入力行動 == 2101
		LOCALS:10 = 
	;その他（特殊弾丸）
	ELSE
		LOCALS:10 = 
	ENDIF
;-------------------------------------------------
;基本行動
;-------------------------------------------------
ELSEIF RANGE(CFLAG:ARG:入力行動,2301, 2400)
	;ＣＨＡＮＧＥ
	IF CFLAG:ARG:入力行動 == 2301
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;-------------------------------------------------
;アイテム
;-------------------------------------------------
ELSEIF RANGE(CFLAG:ARG:入力行動,3001, 3500)
	LOCALS:10 = 
;-------------------------------------------------
;リンケージ
;-------------------------------------------------
ELSEIF RANGE(CFLAG:ARG:入力行動,4000, 5000)
	;メシアライザー
	IF CFLAG:ARG:入力行動 == 4160
		LOCALS:10 = 
	;Lヒートライザ
	ELSEIF CFLAG:ARG:入力行動 == 4200
		LOCALS:10 = 
	;死亡遊戯
	ELSEIF CFLAG:ARG:入力行動 == 4800
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;-------------------------------------------------
;汎用スキル
;-------------------------------------------------
;剣撃
ELSEIF RANGE(CFLAG:ARG:入力行動,1, 99)
	LOCALS:10 = 
;飛具
ELSEIF RANGE(CFLAG:ARG:入力行動,101, 199)
	LOCALS:10 = 
;打撃
ELSEIF RANGE(CFLAG:ARG:入力行動,201, 299)
	LOCALS:10 = 
;戦技
ELSEIF RANGE(CFLAG:ARG:入力行動,301, 400)
	;噛み付き系
	IF RANGE(CFLAG:ARG:入力行動,321, 326)
		LOCALS:10 = 
	;その他
	ELSE
		LOCALS:10 = 
	ENDIF
;回復
ELSEIF RANGE(CFLAG:ARG:入力行動,401, 499)
	;全体回復
	IF CFLAG:ARG:ターゲット > 6
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;支援
ELSEIF RANGE(CFLAG:ARG:入力行動,501, 599)
	;強化系
	IF RANGE(CFLAG:ARG:入力行動,501, 505) || CFLAG:ARG:入力行動 == 558
		LOCALS:10 = 
	;弱体系
	ELSEIF RANGE(CFLAG:ARG:入力行動,506, 509) || CFLAG:ARG:入力行動 == 541 || CFLAG:ARG:入力行動 == 556
		LOCALS:10 = 
	;挑発
	ELSEIF CFLAG:ARG:入力行動 == 515
		LOCALS:10 = 
	;その他
	ELSE
		LOCALS:10 = 
	ENDIF
;防御
ELSEIF RANGE(CFLAG:ARG:入力行動,601, 699)
	LOCALS:10 = 
;火炎
ELSEIF RANGE(CFLAG:ARG:入力行動,701, 799)
	LOCALS:10 = 
;氷結
ELSEIF RANGE(CFLAG:ARG:入力行動,801, 899)
	LOCALS:10 = 
;電撃
ELSEIF RANGE(CFLAG:ARG:入力行動,901, 999)
	LOCALS:10 = 
;衝撃
ELSEIF RANGE(CFLAG:ARG:入力行動,1001, 1099)
	LOCALS:10 = 
;神経
ELSEIF RANGE(CFLAG:ARG:入力行動,1101, 1199)
	LOCALS:10 = 
;精神
ELSEIF RANGE(CFLAG:ARG:入力行動,1201, 1299)
	LOCALS:10 = 
;破魔
ELSEIF RANGE(CFLAG:ARG:入力行動,1301, 1399)
	LOCALS:10 = 
;呪殺
ELSEIF RANGE(CFLAG:ARG:入力行動,1401, 1499)
	LOCALS:10 = 
;地変
ELSEIF RANGE(CFLAG:ARG:入力行動,1501, 1599)
	LOCALS:10 = 
;水撃
ELSEIF RANGE(CFLAG:ARG:入力行動,1601, 1699)
	LOCALS:10 = 
;疾風
ELSEIF RANGE(CFLAG:ARG:入力行動,1701, 1799)
	LOCALS:10 = 
;重力
ELSEIF RANGE(CFLAG:ARG:入力行動,1801, 1899)
	LOCALS:10 = 
;核熱
ELSEIF RANGE(CFLAG:ARG:入力行動,1901, 1999)
	LOCALS:10 = 
;万能
ELSEIF RANGE(CFLAG:ARG:入力行動,2001, 2099)
	;自爆系
	IF RANGE(CFLAG:ARG:入力行動,2005, 2007)
		LOCALS:10 = 
	ELSE
		LOCALS:10 = 
	ENDIF
;魔法少女系
ELSEIF RANGE(CFLAG:ARG:入力行動,2989, 2999)
	LOCALS:10 = 
;-------------------------------------------------
;その他
;-------------------------------------------------
ELSE
	LOCALS:10 = 
ENDIF
;-------------------------------------------------
;真・その他
;-------------------------------------------------
IF LOCALS:10 == ""
	;必ず何か喋る
	LOCALS:10 = 
ENDIF

IF !(LOCALS:10 == "")
	CALL MESSAGE_B2(CALLNAME:ARG,(KSTR:0 == ""), LOCALS:10, LOCALS:11, LOCALS:12, LOCALS:13, LOCALS:14)
	SIF !(KSTR:0 == "")
		CALL 口上変数表示
ENDIF
RETURN

;IF !(LOCALS:10 == "") && !(KSTR:0 == "")
;	CALL MESSAGE_B2(CALLNAME:ARG,0, LOCALS:10, LOCALS:11, LOCALS:12, LOCALS:13, LOCALS:14)
;	CALL 口上変数表示
;ELSEIF !(LOCALS:10 == "")
;	CALL MESSAGE_B2(CALLNAME:ARG,1, LOCALS:10, LOCALS:11, LOCALS:12, LOCALS:13, LOCALS:14)
;ENDIF
