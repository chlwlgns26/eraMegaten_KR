
;イベントフラグ:80:0 = イベント閲覧チェック（未体験=0体験済=1）

;====================
;条件
;====================
@PLAYABLE_EVENT_81
RESULTS = 悪魔分布WIKI作成
	RETURN 1


;====================
;内容
;====================
@SHOPCOM_EVENT_81

	PRINTW 文章テスト
CALL 文章テスト_81

@文章テスト_81
#DIM 出現場所,99
#DIM 出現場所階数,99
#DIM 最大階数,100
#DIM 指定XY軸,100
#DIM 悪魔分布,100,200,2
FOR LOCAL , 0 , 100
	TRYCCALLFORM GET_DUNGEON_NAME_{LOCAL}
		IF RESULTS == "タルタロス"
			;PRINTFORML #DEFINE ダンジョン%TOSTR(LOCAL , "00")% %RESULTS%
			;PRINTFORML #DIM ダンジョン%TOSTR(LOCAL , "00")%MAP数 22
			最大階数:LOCAL = 22
			指定XY軸:LOCAL = 30
			CONTINUE
		ENDIF
		FLAG:現ダンジョン = LOCAL
		;PRINTFORML #DEFINE ダンジョン%TOSTR(LOCAL , "00")% %RESULTS%
		LOCAL:2 = 0 , 0 , 0
		FOR FLAG:現M , 0 , 100
			FLAG:最大X = 0
			FLAG:最大Y = 0
			CALLFORM MAKE_FLOOR_{LOCAL}
			LOCAL:2 = MAX(FLAG:最大X , LOCAL:2)
			LOCAL:3 = MAX(FLAG:最大Y , LOCAL:3)
			SIF (FLAG:最大X + FLAG:最大Y) > 2
				LOCAL:4 = FLAG:現M
		NEXT
		最大階数:LOCAL = LOCAL:4
		指定XY軸:LOCAL = MIN(LOCAL:2 , LOCAL:3)
	CATCH
		最大階数:LOCAL = 0
		指定XY軸:LOCAL = 0
	ENDCATCH
;	PRINTFORML CASE "ダンジョン%TOSTR(LOCAL , "00")%"
;	PRINTFORML ダンジョン%TOSTR(LOCAL , "00")%:(ARG:3):(ARG:1):(ARG:2) = LOCAL
NEXT
VARSET 悪魔分布,0
FLAG:未遭遇歩数 = 99

FOR LOCAL:1,1,100
	IF LOCAL:1 == 70
		FOR ダンジョンフラグ:70:(50),-5,49
				FOR LOCAL:2,0,1000
					TRYCALLFORM ENEMY_{LOCAL:1},RAND:3 + 1
					LOCAL:3 = RESULT
					IF LOCAL:3 < 1
						BREAK
					ELSE
						FOR LOCAL:4,0,500
							SIF LOCAL:3 != 0 && 悪魔分布:(LOCAL:1):(LOCAL:4):0 == LOCAL:3
								BREAK
							IF 悪魔分布:(LOCAL:1):(LOCAL:4):0 < 1
								悪魔分布:(LOCAL:1):(LOCAL:4):0 = LOCAL:3
								悪魔分布:(LOCAL:1):(LOCAL:4):1 = ダンジョンフラグ:70:(50)
								BREAK
							ENDIF
						NEXT
					ENDIF
				NEXT
		NEXT
		CONTINUE
	ENDIF
	SIF LOCAL:1 == 94
		CONTINUE
	FLAG:現ダンジョン = LOCAL:1
	;FLAG:最大X = 0
	;FLAG:最大Y = 0
	;TRYCCALLFORM MAKE_FLOOR_{LOCAL:1}
		FOR FLAG:現M,0,最大階数:(LOCAL:1)
				FOR FLAG:現X,0,指定XY軸:(LOCAL:1)
					FLAG:現Y = FLAG:現X
					FLAG:エンカウント率 = 0
					FLAG:未遭遇歩数 = 9999
					TRYCALLFORM ENCOUNT_RATE_{LOCAL:1}
					RESULT = 0
					IF FLAG:エンカウント率 > 0
						FOR LOCAL:2,0,1000
							TRYCALLFORM ENEMY_{LOCAL:1},RAND:3 + 1
							LOCAL:3 = RESULT
							IF LOCAL:3 < 1
								BREAK
							ELSE
								FOR LOCAL:4,0,500
									SIF LOCAL:3 != 0 && 悪魔分布:(LOCAL:1):(LOCAL:4):0 == LOCAL:3
										BREAK
									IF 悪魔分布:(LOCAL:1):(LOCAL:4):0 < 1
										悪魔分布:(LOCAL:1):(LOCAL:4):0 = LOCAL:3
										悪魔分布:(LOCAL:1):(LOCAL:4):1 = FLAG:現M
										BREAK
									ENDIF
								NEXT
							ENDIF
							FLAG:現X = RAND:(指定XY軸:(LOCAL:1))
							FLAG:現Y = FLAG:現X
						NEXT
						BREAK
					ENDIF
				NEXT
		NEXT
	;CATCH
	;ENDCATCH
NEXT


CLEARLINE 6000

PRINTFORML 
PRINTFORML 鮪飴
PRINTFORML 鮪飴


FOR LOCAL,1,4401

	; 半魔、リンク専用、ペルソナ専用を除外
	;SIF LOCAL >= 3500 && LOCAL <= 3699
	;	CONTINUE
	;SIF LOCAL >= 3800 && LOCAL <= 3999
	;	CONTINUE
	SIF LOCAL == 3501
		LOCAL = 3701
	SIF LOCAL == 3801
		LOCAL = 4001
	
	;メリーさん除外
	SIF LOCAL == 1082
		CONTINUE

	;幻影の幽霊のマシン除外
	SIF LOCAL >= 1116 && LOCAL <= 1118
		CONTINUE

	; 悪魔ほむら除外
	SIF LOCAL == 298
		CONTINUE
	; まどマギ怪異除外
	SIF LOCAL >= 3380 && LOCAL <= 3399
		CONTINUE
	; まどマギ系除外
	SIF LOCAL >= 4390 && LOCAL <= 4399
		CONTINUE
	;SIF LOCAL == 4201
	;	LOCAL = 4301
	IF LOCAL % 100 == 1
		IF 3000 < LOCAL && 3400 > LOCAL
			PRINTFORML 鮪飴*%STR:(LOCAL / 100)%
		ELSEIF LOCAL == 3701
			PRINTFORML 鮪飴*変異悪魔専用
		ELSE
			PRINTFORML 鮪飴*%STR:(LOCAL / 100 + 1)%
		ENDIF
		PRINTFORML 鮪飴[+]
			PRINTL 鮪飴{| class="sort edit filter" width="100%"
		PRINTFORML 鮪飴|size(14)|size(14)|size(14)|size(14)|size(14)|size(14)|size(14)|size(14)|c
			PRINTL 鮪飴|right|left|right|right|right|right|right|left|right|right|right|right|c
			PRINTL 鮪飴|~No|名称|LV|通常合体|合体条件|全書召喚|会話|出現場所|
	ENDIF
	
		IF EXISTCSV(LOCAL,0)
			PRINTFORM 鮪飴|{LOCAL}|
			PRINTFORM [[%CSVCALLNAME(LOCAL,0)%]]|
			PRINTFORM {CSVBASE(LOCAL,GETNUM(BASE,"LV"),0)}|
			LOCAL:1 = CSVABL(LOCAL,GETNUM(ABL,"種族"),0)
			IF CSVCFLAG(LOCAL,GETNUM(CFLAG,"特殊合体のみ"),0)
				PRINTFORM ×|
			ELSEIF LOCAL:1 == 17 || LOCAL:1 == 18
				PRINTFORM △|
			ELSEIF (LOCAL:1 > 0 && LOCAL:1 < 12) || LOCAL:1 == 13 || LOCAL:1 == 15 || LOCAL:1 == 16
				PRINTFORM ○|
			ELSE
				PRINTFORM ×|
			ENDIF
			IF CSVCFLAG(LOCAL,GETNUM(CFLAG,"合体条件有り"),0)
				PRINTFORM 有|
			ELSE
				PRINTFORM 無|
			ENDIF
			IF CSVCFLAG(LOCAL,GETNUM(CFLAG,"全書召喚不可"),0)
				PRINTFORM 不|
			ELSEIF LOCAL:1 > 18
				PRINTFORM 不|
			ELSE
				PRINTFORM 可|
			ENDIF
			SELECTCASE CSVABL(LOCAL,GETNUM(ABL,"会話タイプ"),0)
			CASE IS < 301
				PRINTFORM ？|
			CASE IS < 331
				PRINTFORM ○|
			CASE 331
				PRINTFORM ×|
			CASEELSE
				PRINTFORM ？|
			ENDSELECT
			VARSET 出現場所,0
			VARSET 出現場所階数,0
			LOCAL:3 = 0
			FOR LOCAL:1,1,100
				SIF LOCAL:1 == 94
					CONTINUE
											FOR LOCAL:2,0,200
												IF 悪魔分布:(LOCAL:1):(LOCAL:2):0 == LOCAL
													出現場所:(LOCAL:3) = LOCAL:1
													出現場所階数:(LOCAL:3) = 悪魔分布:(LOCAL:1):(LOCAL:2):1
													LOCAL:3 ++
													BREAK
												ENDIF
											NEXT
					;SIF LOCAL:3 > 3
					;	BREAK
			NEXT
			FOR LOCAL:1,0,99
				IF 出現場所:(LOCAL:1) > 0
					CALLFORM GET_DUNGEON_NAME_{出現場所:(LOCAL:1)}
					PRINTFORM %RESULTS%:
					IF 出現場所:(LOCAL:1) == 70
						PRINTFORM {出現場所階数:(LOCAL:1)}F~~
					ELSE
						FLAG:現M = 出現場所階数:(LOCAL:1)
						TRYCALLFORM FLOORNAME_{出現場所:(LOCAL:1)}
						PRINTFORM ({出現場所階数:(LOCAL:1)})~~
					ENDIF
				ELSE
					BREAK
				ENDIF
			NEXT
			PRINTL |
			
			
		ENDIF
		
	IF LOCAL % 100 == 0
		PRINTFORML 鮪飴|\}
			PRINTL 鮪飴[END]
	ENDIF
NEXT
PRINTL 鮪飴
PRINTL 鮪飴
PRINTL 鮪飴
WAIT